<html>
<head>
  <title>33, 34, 35.- Nested, Merge, Has Join</title>
  <basefont face="Tahoma" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/301769 (en-US); Windows/10.0.14342 (Win64);"/>
  <style>
    body, td {
      font-family: Tahoma;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1113"/>
<h1>33, 34, 35.- Nested, Merge, Has Join</h1>

<div>
<span><div>33, 34, 35.- Nested, Merge, Has Join</div><div><br/></div><div><h2 style="box-sizing: border-box; margin: 0.2rem 0px 0.5rem; padding: 0px; color: rgb(34, 34, 34); font-style: normal; font-weight: normal; text-rendering: optimizeLegibility; font-size: 2.3125rem; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: center; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">Introduction: What are Join Operators?</h2><p style="box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 20px; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-size: 16px; font-weight: normal; text-rendering: optimizeLegibility; color: rgb(139, 137, 137); text-align: left; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">A join operator is a type of an algorithm which the SQL Server Optimizer chooses in order to implement logical joins between two sets of data.</p><p style="box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 20px; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-size: 16px; font-weight: normal; text-rendering: optimizeLegibility; color: rgb(139, 137, 137); text-align: left; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">The SQL Server Optimizer may choose a different algorithm for different scenarios based on the requested query, available indexes, statistics and number of estimated rows in each data set.</p><p style="box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 20px; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-size: 16px; font-weight: normal; text-rendering: optimizeLegibility; color: rgb(139, 137, 137); text-align: left; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">It’s possible to find the operator which was used by looking at the execution plan that SQL Server has prepared for your query.</p><p style="box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 20px; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-size: 16px; font-weight: normal; text-rendering: optimizeLegibility; color: rgb(139, 137, 137); text-align: left; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">For more information on execution plans and how to read them, I recommend checking out the first chapter out of Grant Fritchey’s excellent book:<br style="box-sizing: border-box;"/><a href="http://www.simple-talk.com/sql/performance/execution-plan-basics/" style="box-sizing: border-box; color: rgb(32, 43, 91); text-decoration: none; font-family: &apos;Open Sans Hebrew&apos;, sans-serif !important;" target="_blank">http://www.simple-talk.com/sql/performance/execution-plan-basics/</a></p><h2 style="box-sizing: border-box; margin: 0.2rem 0px 0.5rem; padding: 0px; color: rgb(34, 34, 34); font-style: normal; font-weight: normal; text-rendering: optimizeLegibility; font-size: 2.3125rem; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: center; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">NESTED LOOPS</h2><p style="box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 20px; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-size: 16px; font-weight: normal; text-rendering: optimizeLegibility; color: rgb(139, 137, 137); text-align: left; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">“Nested Loops” is the simplest operator of the bunch.</p><p style="box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 20px; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-size: 16px; font-weight: normal; text-rendering: optimizeLegibility; color: rgb(139, 137, 137); text-align: left; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">We’ll take the following query as an example, which gets some order detail columns for orders placed during July 2001 (assuming the OrderDate column only includes dates without time):</p><p style="box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 20px; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-size: 16px; font-weight: normal; text-rendering: optimizeLegibility; color: rgb(139, 137, 137); text-align: left; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"></p><div style="box-sizing: border-box; margin: 12px 0px; padding: 0px; text-align: left; overflow: hidden !important; position: relative !important; direction: ltr !important; width: 882px; font-family: Monaco, MonacoRegular, &apos;Courier New&apos;, monospace; font-weight: 500; border: 1px solid rgb(153, 153, 153) !important; text-shadow: none !important; color: rgb(34, 34, 34); font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-size: 12px !important; height: auto; background: rgb(253, 253, 253) !important;"><div style="box-sizing: border-box; margin: 0px; padding: 0px; font-family: Monaco, MonacoRegular, &apos;Courier New&apos;, monospace !important; border: 0px; text-align: left; width: 880px; overflow: hidden; position: relative; z-index: 1; background: 0px 50%;"><table style="box-sizing: border-box; border: none !important; margin-bottom: 0px !important; table-layout: auto !important; font-size: 12px; padding: 0px !important; margin-right: 0px !important; margin-left: 0px; margin-top: 0px !important; font-family: Monaco, MonacoRegular, &apos;Courier New&apos;, monospace !important; border-spacing: 0px !important; border-collapse: collapse !important; background: none !important;width:881px;"><tr style="box-sizing: border-box; font-family: Monaco, MonacoRegular, &apos;Courier New&apos;, monospace !important; padding: 0px !important; border: none !important; vertical-align: top !important; margin: 0px !important; background: 0px 50%;"><td style="box-sizing: border-box; margin: 0px !important; padding: 0px !important; color: rgb(84, 153, 222) !important; font-size: 0.875rem; text-align: left; display: table-cell; font-family: Monaco, MonacoRegular, &apos;Courier New&apos;, monospace !important; vertical-align: top !important; border: 0px; background: rgb(223, 239, 255) !important;width:4.0862656072644725%;"><div style="box-sizing: border-box; margin: 0px; padding: 0px; font-family: Monaco, MonacoRegular, &apos;Courier New&apos;, monospace !important; border: 0px; text-align: left; white-space: nowrap; font-size: 12px !important; background: 0px 50%;"><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: center; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: 0px 50%;">1</div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: center; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(49, 124, 197) !important; background: rgb(200, 225, 250) !important;">2</div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: center; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: 0px 50%;">3</div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: center; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(49, 124, 197) !important; background: rgb(200, 225, 250) !important;">4</div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: center; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: 0px 50%;">5</div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: center; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(49, 124, 197) !important; background: rgb(200, 225, 250) !important;">6</div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: center; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: 0px 50%;">7</div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: center; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(49, 124, 197) !important; background: rgb(200, 225, 250) !important;">8</div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: center; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: 0px 50%;">9</div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: center; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(49, 124, 197) !important; background: rgb(200, 225, 250) !important;">10</div></div></td><td style="box-sizing: border-box; margin: 0px !important; padding: 0px !important; color: rgb(34, 34, 34); font-size: 0.875rem; text-align: left; display: table-cell; font-family: Monaco, MonacoRegular, &apos;Courier New&apos;, monospace !important; vertical-align: top !important; border: 0px; background: 0px 50%;width:96.0272417707151%;"><div style="box-sizing: border-box; margin: 0px; padding: 0px; font-family: Monaco, MonacoRegular, &apos;Courier New&apos;, monospace !important; border: none !important; text-align: left; color: rgb(0, 0, 0); white-space: pre; overflow: visible; tab-size: 4; font-size: 12px !important; background: none !important;"><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: left; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: 0px 50%;"><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(128, 0, 128) !important;">SELECT</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: left; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: rgb(247, 247, 247) !important;"><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">OH</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">.</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">OrderDate</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">,</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">OD</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">.</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">OrderQty</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">,</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">OD</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">.</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">ProductID</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">,</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">OD</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">.</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">UnitPrice</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: left; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: 0px 50%;"><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(128, 0, 128) !important;">FROM</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: left; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: rgb(247, 247, 247) !important;"><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">Sales</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">.</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">SalesOrderHeader</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(128, 0, 128) !important;">AS</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">OH</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: left; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: 0px 50%;"><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(128, 0, 128) !important;">JOIN</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: left; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: rgb(247, 247, 247) !important;"><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">Sales</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">.</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">SalesOrderDetail</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(128, 0, 128) !important;">AS</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">OD</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: left; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: 0px 50%;"><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(128, 0, 128) !important;">ON</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: left; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: rgb(247, 247, 247) !important;"><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">OH</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">.</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">SalesOrderID</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 111, 224) !important;">=</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">OD</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">.</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">SalesOrderID</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: left; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: 0px 50%;"><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(128, 0, 128) !important;">WHERE</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: left; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: rgb(247, 247, 247) !important;"><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">OH</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">.</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">OrderDate</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(128, 0, 128) !important;">BETWEEN</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 128, 0) !important;">'2001-07-01'</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(128, 0, 128) !important;">AND</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 128, 0) !important;">'2001-07-31'</span></div></div></td></tr></table></div></div><p style="box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 20px; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-size: 16px; font-weight: normal; text-rendering: optimizeLegibility; color: rgb(139, 137, 137); text-align: left; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"></p><div style="box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 20px; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-weight: normal; text-rendering: optimizelegibility; color: rgb(139, 137, 137); text-align: left; font-style: normal; font-variant: normal; letter-spacing: normal; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); font-size: 16px;"><div><br/></div></div><p style="box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 20px; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-size: 16px; font-weight: normal; text-rendering: optimizeLegibility; color: rgb(139, 137, 137); text-align: left; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">The operator on the top right is called the <strong style="box-sizing: border-box; font-weight: bold;">outer input</strong> and the one just below it is called the <strong style="box-sizing: border-box; font-weight: bold;">inner input</strong>.</p><p style="box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 20px; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-size: 16px; font-weight: normal; text-rendering: optimizeLegibility; color: rgb(139, 137, 137); text-align: left; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">What the “Nested Loops” operator basically does is: <span style="box-sizing: border-box; text-decoration: underline;">For each record</span> from the <strong style="box-sizing: border-box; font-weight: bold;">outer input</strong> – find matching rows from the <strong style="box-sizing: border-box; font-weight: bold;">inner input</strong>.</p><p style="box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 20px; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-size: 16px; font-weight: normal; text-rendering: optimizeLegibility; color: rgb(139, 137, 137); text-align: left; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">Technically, this means that the clustered index scan you see as the outer input is executed once to get all the relevant records, and the clustered index seek you see below it is executed <span style="box-sizing: border-box; text-decoration: underline;">for each record</span> from the outer input.</p><p style="box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 20px; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-size: 16px; font-weight: normal; text-rendering: optimizeLegibility; color: rgb(139, 137, 137); text-align: left; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">We’ll verify this information by placing the cursor over the Clustered Index Scan operator and looking at the tooltip:</p><div style="box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 20px; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-weight: normal; text-rendering: optimizelegibility; color: rgb(139, 137, 137); text-align: left; font-style: normal; font-variant: normal; letter-spacing: normal; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); font-size: 16px;"><div><br/></div></div><div style="box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 20px; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-weight: normal; text-rendering: optimizelegibility; color: rgb(139, 137, 137); text-align: left; font-style: normal; font-variant: normal; letter-spacing: normal; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); font-size: 16px;"><div>We can see that the estimated number of executions is 1.</div></div><div style="box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 20px; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-weight: normal; text-rendering: optimizelegibility; color: rgb(139, 137, 137); text-align: left; font-style: normal; font-variant: normal; letter-spacing: normal; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); font-size: 16px;"><div><br/></div></div><p style="box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 20px; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-size: 16px; font-weight: normal; text-rendering: optimizeLegibility; color: rgb(139, 137, 137); text-align: left; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">This time we can see that the estimated number of executions is 179 which is the approximate number of rows returned from the outer input.</p><p style="box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 20px; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-size: 16px; font-weight: normal; text-rendering: optimizeLegibility; color: rgb(139, 137, 137); text-align: left; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">In terms of complexity (assume <strong style="box-sizing: border-box; font-weight: bold;">N</strong> is the number of rows from the outer output and <strong style="box-sizing: border-box; font-weight: bold;">M</strong> is the total number of rows in the SalesOrderDetail table): The complexity of this query is: <strong style="box-sizing: border-box; font-weight: bold;">O(NlogM)</strong> where “logM” is the complexity of each seek in the inner input.</p><p style="box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 20px; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-size: 16px; font-weight: normal; text-rendering: optimizeLegibility; color: rgb(139, 137, 137); text-align: left; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">The SQL Server Optimizer will prefer to choose this operator type when the outer input is small and the inner input has an index on the column(s) by which the two data sets are joined. The bigger the difference in number of rows between the outer and inner inputs, the more benefit this operator will provide over the other operator types.</p><p style="box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 20px; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-size: 16px; font-weight: normal; text-rendering: optimizeLegibility; color: rgb(139, 137, 137); text-align: left; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">Having indexes and up-to-date statistics is crucial for this join type, because you don’t want SQL Server to accidently think there’s a small number of rows in one of the inputs when in fact there are a whole lot. For example: Performing 10 times index seek is nothing like performing 100,000 times index seek, especially if the table size of the inner input is around 120,000 and you’d be better off doing one table scan instead.</p><h2 style="box-sizing: border-box; margin: 0.2rem 0px 0.5rem; padding: 0px; color: rgb(34, 34, 34); font-style: normal; font-weight: normal; text-rendering: optimizeLegibility; font-size: 2.3125rem; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: center; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">MERGE Join</h2><p style="box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 20px; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-size: 16px; font-weight: normal; text-rendering: optimizeLegibility; color: rgb(139, 137, 137); text-align: left; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">The “Merge” algorithm is the most efficient way to join between two very large sets of data which are both sorted on the join key.</p><p style="box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 20px; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-size: 16px; font-weight: normal; text-rendering: optimizeLegibility; color: rgb(139, 137, 137); text-align: left; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">We’ll use the following query as an example (which returns a list of customers and their sale order identifiers):</p><p style="box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 20px; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-size: 16px; font-weight: normal; text-rendering: optimizeLegibility; color: rgb(139, 137, 137); text-align: left; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"></p><div style="box-sizing: border-box; margin: 12px 0px; padding: 0px; text-align: left; overflow: hidden !important; position: relative !important; direction: ltr !important; width: 882px; font-family: Monaco, MonacoRegular, &apos;Courier New&apos;, monospace; font-weight: 500; border: 1px solid rgb(153, 153, 153) !important; text-shadow: none !important; color: rgb(34, 34, 34); font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-size: 12px !important; height: auto; background: rgb(253, 253, 253) !important;"><div style="box-sizing: border-box; margin: 0px; padding: 0px; font-family: Monaco, MonacoRegular, &apos;Courier New&apos;, monospace !important; border: 0px; text-align: left; width: 880px; overflow: hidden; position: relative; z-index: 1; background: 0px 50%;"><table style="box-sizing: border-box; border: none !important; margin-bottom: 0px !important; table-layout: auto !important; font-size: 12px; padding: 0px !important; margin-right: 0px !important; margin-left: 0px; margin-top: 0px !important; font-family: Monaco, MonacoRegular, &apos;Courier New&apos;, monospace !important; border-spacing: 0px !important; border-collapse: collapse !important; background: none !important;width:881px;"><tr style="box-sizing: border-box; font-family: Monaco, MonacoRegular, &apos;Courier New&apos;, monospace !important; padding: 0px !important; border: none !important; vertical-align: top !important; margin: 0px !important; background: 0px 50%;"><td style="box-sizing: border-box; margin: 0px !important; padding: 0px !important; color: rgb(84, 153, 222) !important; font-size: 0.875rem; text-align: left; display: table-cell; font-family: Monaco, MonacoRegular, &apos;Courier New&apos;, monospace !important; vertical-align: top !important; border: 0px; background: rgb(223, 239, 255) !important;width:4.0862656072644725%;"><div style="box-sizing: border-box; margin: 0px; padding: 0px; font-family: Monaco, MonacoRegular, &apos;Courier New&apos;, monospace !important; border: 0px; text-align: left; white-space: nowrap; font-size: 12px !important; background: 0px 50%;"><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: center; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: 0px 50%;">1</div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: center; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(49, 124, 197) !important; background: rgb(200, 225, 250) !important;">2</div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: center; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: 0px 50%;">3</div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: center; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(49, 124, 197) !important; background: rgb(200, 225, 250) !important;">4</div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: center; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: 0px 50%;">5</div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: center; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(49, 124, 197) !important; background: rgb(200, 225, 250) !important;">6</div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: center; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: 0px 50%;">7</div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: center; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(49, 124, 197) !important; background: rgb(200, 225, 250) !important;">8</div></div></td><td style="box-sizing: border-box; margin: 0px !important; padding: 0px !important; color: rgb(34, 34, 34); font-size: 0.875rem; text-align: left; display: table-cell; font-family: Monaco, MonacoRegular, &apos;Courier New&apos;, monospace !important; vertical-align: top !important; border: 0px; background: 0px 50%;width:96.0272417707151%;"><div style="box-sizing: border-box; margin: 0px; padding: 0px; font-family: Monaco, MonacoRegular, &apos;Courier New&apos;, monospace !important; border: none !important; text-align: left; color: rgb(0, 0, 0); white-space: pre; overflow: visible; tab-size: 4; font-size: 12px !important; background: none !important;"><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: left; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: 0px 50%;"><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(128, 0, 128) !important;">SELECT</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: left; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: rgb(247, 247, 247) !important;"><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">OC</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">.</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">CustomerID</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">,</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">OH</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">.</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">SalesOrderID</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: left; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: 0px 50%;"><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(128, 0, 128) !important;">FROM</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: left; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: rgb(247, 247, 247) !important;"><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">Sales</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">.</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">SalesOrderHeader</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(128, 0, 128) !important;">AS</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">OH</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: left; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: 0px 50%;"><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(128, 0, 128) !important;">JOIN</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: left; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: rgb(247, 247, 247) !important;"><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">Sales</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">.</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">Customer</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(128, 0, 128) !important;">AS</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">OC</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: left; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: 0px 50%;"><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(128, 0, 128) !important;">ON</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: left; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: rgb(247, 247, 247) !important;"><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">OH</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">.</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">CustomerID</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 111, 224) !important;">=</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">OC</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">.</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">CustomerID</span></div></div></td></tr></table></div></div><p style="box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 20px; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-size: 16px; font-weight: normal; text-rendering: optimizeLegibility; color: rgb(139, 137, 137); text-align: left; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"></p><p style="box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 20px; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-size: 16px; font-weight: normal; text-rendering: optimizeLegibility; color: rgb(139, 137, 137); text-align: left; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">The execution plan for this query is:</p><div style="box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 20px; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-weight: normal; text-rendering: optimizelegibility; color: rgb(139, 137, 137); text-align: left; font-style: normal; font-variant: normal; letter-spacing: normal; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); font-size: 16px;"><div><br/></div></div><ul style="box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 40px; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-size: 16px; list-style-position: outside; color: rgb(34, 34, 34); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: center; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><li style="box-sizing: border-box; margin: 0px; padding: 0px; text-align: left;"><div style="box-sizing: border-box; margin: 0px; padding: 0px;">First, we’ll notice that both of the data sets are sorted on the CustomerID column: The Customer table because that’s the clustered primary key, and the SalesOrderHeader table because there’s a nonclustered index on the CustomerID column.</div></li><li style="box-sizing: border-box; margin: 0px; padding: 0px; text-align: left;"><div style="box-sizing: border-box; margin: 0px; padding: 0px;">By the width of the arrows between the operators (and by placing the cursor over them), we can see that the number of rows returned from each set is rather large.</div></li><li style="box-sizing: border-box; margin: 0px; padding: 0px; text-align: left;"><div style="box-sizing: border-box; margin: 0px; padding: 0px;">In addition, we used the equality operator (=) in the ON clause (the Merge join requires an equality operator).</div></li></ul><p style="box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 20px; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-size: 16px; font-weight: normal; text-rendering: optimizeLegibility; color: rgb(139, 137, 137); text-align: left; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">These three factors cause SQL Server Optimizer to choose the Merge Join for this query.</p><p style="box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 20px; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-size: 16px; font-weight: normal; text-rendering: optimizeLegibility; color: rgb(139, 137, 137); text-align: left; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">The biggest performance gain from this join type is that both input operators are executed only once. We can verify this by placing the cursor over them and see that the number of executions is 1 for both of the operators. Also, the algorithm itself is very efficient:</p><p style="box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 20px; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-size: 16px; font-weight: normal; text-rendering: optimizeLegibility; color: rgb(139, 137, 137); text-align: left; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">The Merge Join simultaneously reads a row from each input and compares them using the join key. If there’s a match, they are returned. Otherwise, the row with the smaller value can be discarded because, since both inputs are sorted, the discarded row will not match any other row on the other set of data.</p><p style="box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 20px; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-size: 16px; font-weight: normal; text-rendering: optimizeLegibility; color: rgb(139, 137, 137); text-align: left; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">This repeats until one of the tables is completed. Even if there are still rows on the other table, they will clearly not match any rows on the fully-scanned table, so there is no need to continue. Since both tables can potentially be scanned, the maximum cost of a Merge Join is the sum of both inputs. Or in terms of complexity: <strong style="box-sizing: border-box; font-weight: bold;">O(N+M)</strong></p><p style="box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 20px; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-size: 16px; font-weight: normal; text-rendering: optimizeLegibility; color: rgb(139, 137, 137); text-align: left; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">If the inputs are not both sorted on the join key, the SQL Server Optimizer will most likely not choose the Merge join type and instead prefer the Hash join (will be explained soon). However if it does anyway (whether it’s because it was forced to due to a join hint, or because it was still the most efficient), then SQL will need to sort the table which is not already sorted on the join key.</p><h2 style="box-sizing: border-box; margin: 0.2rem 0px 0.5rem; padding: 0px; color: rgb(34, 34, 34); font-style: normal; font-weight: normal; text-rendering: optimizeLegibility; font-size: 2.3125rem; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: center; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">HASH Match</h2><p style="box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 20px; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-size: 16px; font-weight: normal; text-rendering: optimizeLegibility; color: rgb(139, 137, 137); text-align: left; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">The “Hash” join type is what I call “the go-to guy” of the join operators. It’s the one operator chosen when the scenario doesn’t favor in any of the other join types. This happens when the tables are not properly sorted, and/or there are no indexes. When SQL Server Optimizer chooses the Hash join type, it’s usually a bad sign because something probably could’ve been done better (for example, adding an index). However, in some cases (complex queries mostly), there’s simply no other way.</p><p style="box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 20px; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-size: 16px; font-weight: normal; text-rendering: optimizeLegibility; color: rgb(139, 137, 137); text-align: left; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">We’ll use the following query as an example (which gets the first and last names of contacts starting with “John” and their sales order identifiers):</p><p style="box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 20px; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-size: 16px; font-weight: normal; text-rendering: optimizeLegibility; color: rgb(139, 137, 137); text-align: left; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"></p><div style="box-sizing: border-box; margin: 12px 0px; padding: 0px; text-align: left; overflow: hidden !important; position: relative !important; direction: ltr !important; width: 882px; font-family: Monaco, MonacoRegular, &apos;Courier New&apos;, monospace; font-weight: 500; border: 1px solid rgb(153, 153, 153) !important; text-shadow: none !important; color: rgb(34, 34, 34); font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-size: 12px !important; height: auto; background: rgb(253, 253, 253) !important;"><div style="box-sizing: border-box; margin: 0px; padding: 0px; font-family: Monaco, MonacoRegular, &apos;Courier New&apos;, monospace !important; border: 0px; text-align: left; width: 880px; overflow: hidden; position: relative; z-index: 1; background: 0px 50%;"><table style="box-sizing: border-box; border: none !important; margin-bottom: 0px !important; table-layout: auto !important; font-size: 12px; padding: 0px !important; margin-right: 0px !important; margin-left: 0px; margin-top: 0px !important; font-family: Monaco, MonacoRegular, &apos;Courier New&apos;, monospace !important; border-spacing: 0px !important; border-collapse: collapse !important; background: none !important;width:881px;"><tr style="box-sizing: border-box; font-family: Monaco, MonacoRegular, &apos;Courier New&apos;, monospace !important; padding: 0px !important; border: none !important; vertical-align: top !important; margin: 0px !important; background: 0px 50%;"><td style="box-sizing: border-box; margin: 0px !important; padding: 0px !important; color: rgb(84, 153, 222) !important; font-size: 0.875rem; text-align: left; display: table-cell; font-family: Monaco, MonacoRegular, &apos;Courier New&apos;, monospace !important; vertical-align: top !important; border: 0px; background: rgb(223, 239, 255) !important;width:4.0862656072644725%;"><div style="box-sizing: border-box; margin: 0px; padding: 0px; font-family: Monaco, MonacoRegular, &apos;Courier New&apos;, monospace !important; border: 0px; text-align: left; white-space: nowrap; font-size: 12px !important; background: 0px 50%;"><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: center; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: 0px 50%;">1</div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: center; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(49, 124, 197) !important; background: rgb(200, 225, 250) !important;">2</div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: center; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: 0px 50%;">3</div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: center; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(49, 124, 197) !important; background: rgb(200, 225, 250) !important;">4</div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: center; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: 0px 50%;">5</div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: center; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(49, 124, 197) !important; background: rgb(200, 225, 250) !important;">6</div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: center; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: 0px 50%;">7</div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: center; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(49, 124, 197) !important; background: rgb(200, 225, 250) !important;">8</div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: center; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: 0px 50%;">9</div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: center; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(49, 124, 197) !important; background: rgb(200, 225, 250) !important;">10</div></div></td><td style="box-sizing: border-box; margin: 0px !important; padding: 0px !important; color: rgb(34, 34, 34); font-size: 0.875rem; text-align: left; display: table-cell; font-family: Monaco, MonacoRegular, &apos;Courier New&apos;, monospace !important; vertical-align: top !important; border: 0px; background: 0px 50%;width:96.0272417707151%;"><div style="box-sizing: border-box; margin: 0px; padding: 0px; font-family: Monaco, MonacoRegular, &apos;Courier New&apos;, monospace !important; border: none !important; text-align: left; color: rgb(0, 0, 0); white-space: pre; overflow: visible; tab-size: 4; font-size: 12px !important; background: none !important;"><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: left; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: 0px 50%;"><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(128, 0, 128) !important;">SELECT</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: left; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: rgb(247, 247, 247) !important;"><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">OC</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">.</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">FirstName</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">,</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">OC</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">.</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">LastName</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">,</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">OH</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">.</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">SalesOrderID</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: left; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: 0px 50%;"><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(128, 0, 128) !important;">FROM</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: left; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: rgb(247, 247, 247) !important;"><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">Sales</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">.</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">SalesOrderHeader</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(128, 0, 128) !important;">AS</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">OH</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: left; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: 0px 50%;"><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(128, 0, 128) !important;">JOIN</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: left; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: rgb(247, 247, 247) !important;"><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">Person</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">.</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">Contact</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(128, 0, 128) !important;">AS</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">OC</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: left; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: 0px 50%;"><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(128, 0, 128) !important;">ON</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: left; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: rgb(247, 247, 247) !important;"><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">OH</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">.</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">ContactID</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 111, 224) !important;">=</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">OC</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">.</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">ContactID</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: left; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: 0px 50%;"><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(128, 0, 128) !important;">WHERE</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: left; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: rgb(247, 247, 247) !important;"><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">OC</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">.</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">FirstName</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(128, 0, 128) !important;">LIKE</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 128, 0) !important;">'John%'</span></div></div></td></tr></table></div></div><p style="box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 20px; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-size: 16px; font-weight: normal; text-rendering: optimizeLegibility; color: rgb(139, 137, 137); text-align: left; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"></p><div style="box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 20px; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-weight: normal; text-rendering: optimizelegibility; color: rgb(139, 137, 137); text-align: left; font-style: normal; font-variant: normal; letter-spacing: normal; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); font-size: 16px;"><div><br/></div></div><div style="box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 20px; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-weight: normal; text-rendering: optimizelegibility; color: rgb(139, 137, 137); text-align: left; font-style: normal; font-variant: normal; letter-spacing: normal; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); font-size: 16px;"><div><br/></div></div><p style="box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 20px; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-size: 16px; font-weight: normal; text-rendering: optimizeLegibility; color: rgb(139, 137, 137); text-align: left; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">Because there’s no index on the ContactID column in the SalesOrderHeader table, SQL Server chooses the Hash join type.</p><p style="box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 20px; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-size: 16px; font-weight: normal; text-rendering: optimizeLegibility; color: rgb(139, 137, 137); text-align: left; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">Before diving into the example, I’ll first explain two important concepts: A ”Hashing” function and a “Hash Table”.</p><p style="box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 20px; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-size: 16px; font-weight: normal; text-rendering: optimizeLegibility; color: rgb(139, 137, 137); text-align: left; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">“Hashing” is a programmatic function which takes one or more values and converts them to a single symbolic value (usually numeric). The function is usually one-way meaning you can’t convert the symbolic value back to its original value(s), but it’s deterministic meaning if you provide the same value as input you will always get the same symbolic value as output. Also, it’s possible for several different inputs to result in the same output hash value (meaning, the function isn’t necessarily unique).</p><p style="box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 20px; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-size: 16px; font-weight: normal; text-rendering: optimizeLegibility; color: rgb(139, 137, 137); text-align: left; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">A “Hash Table” is a data structure that divides all rows into equal-sized “buckets”, where each “bucket” is represented by a hash value. This means that when you activate the hash function on some row, using the result you’ll know immediately to which bucket it belongs.</p><p style="box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 20px; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-size: 16px; font-weight: normal; text-rendering: optimizeLegibility; color: rgb(139, 137, 137); text-align: left; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">As with the Merge join, the two input operators are executed only once. We can verify this by looking at the tooltips of the input operators.</p><p style="box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 20px; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-size: 16px; font-weight: normal; text-rendering: optimizeLegibility; color: rgb(139, 137, 137); text-align: left; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">Using available statistics, SQL Server will choose the smaller of the two inputs to serve as the <strong style="box-sizing: border-box; font-weight: bold;">build input</strong> and it will be the one used to build the hash table in memory. If there’s not enough memory for the hash table, SQL Server will use physical disk space in TEMPDB. After the hash table is built, SQL Server will get the data from the larger table, called the <strong style="box-sizing: border-box; font-weight: bold;">probe input</strong>, compare it to the hash table using a <em style="box-sizing: border-box; font-style: italic;">hash match function</em>, and return any matched rows. In graphical execution plans, the <strong style="box-sizing: border-box; font-weight: bold;">build input</strong> will always be the one on top, and the <strong style="box-sizing: border-box; font-weight: bold;">probe input</strong> will be the one below.</p><p style="box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 20px; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-size: 16px; font-weight: normal; text-rendering: optimizeLegibility; color: rgb(139, 137, 137); text-align: left; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">As long as the smaller table is very small, this algorithm can be very efficient. But if both tables are very large, this can be a very costly execution plan.</p><p style="box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 20px; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-size: 16px; font-weight: normal; text-rendering: optimizeLegibility; color: rgb(139, 137, 137); text-align: left; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">SQL Server Optimizer uses statistics to figure out the cardinality of the values. Using that information, it <em style="box-sizing: border-box; font-style: italic;">dynamically creates a hash function </em>which will divide the data into as many buckets with sizes as equal as possible.</p><p style="box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 20px; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-size: 16px; font-weight: normal; text-rendering: optimizeLegibility; color: rgb(139, 137, 137); text-align: left; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">Because  it’s so dynamic,  it’s difficult to estimate the complexity of the creation of the hash table and the  complexity of each hash match. Because SQL Server Optimizer performs this dynamic operation during execution time and not during compilation time, sometimes the values you see in the execution plan are incorrect. In some cases, you could compare a hash join and a nested loops join, see that according to the execution plans the nested loop is more expensive (in terms of logical reads etc.), when in fact the hash join executes much slower (because its cost estimation is incorrect).</p><p style="box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 20px; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-size: 16px; font-weight: normal; text-rendering: optimizeLegibility; color: rgb(139, 137, 137); text-align: left; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">For our complexity terms, we’ll assume <strong style="box-sizing: border-box; font-weight: bold;">h<sub style="box-sizing: border-box;">c</sub> </strong>is the complexity of the hash table creation, and <strong style="box-sizing: border-box; font-weight: bold;">h<sub style="box-sizing: border-box;">m</sub> </strong>is the complexity of the hash match function. Therefore, the complexity of the Hash join will be <strong style="box-sizing: border-box; font-weight: bold;">O(N*h<sub style="box-sizing: border-box;">c</sub> + M*h<sub style="box-sizing: border-box;">m</sub> + J)</strong> where <strong style="box-sizing: border-box; font-weight: bold;">N</strong> is the smaller data set, <strong style="box-sizing: border-box; font-weight: bold;">M</strong> is the larger data set and <strong style="box-sizing: border-box; font-weight: bold;">J</strong> is a “joker” complexity addition for the dynamic calculation and creation of the hash function.</p><p style="box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 20px; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-size: 16px; font-weight: normal; text-rendering: optimizeLegibility; color: rgb(139, 137, 137); text-align: left; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">Microsoft has an interesting page in Books Online that describes further Hash Join sub-types and additional aspects about them. I highly recommend you read it: <a href="http://msdn.microsoft.com/en-us/library/ms189313.aspx" style="box-sizing: border-box; color: rgb(32, 43, 91); text-decoration: none; font-family: &apos;Open Sans Hebrew&apos;, sans-serif !important;" target="_blank">http://msdn.microsoft.com/en-us/library/ms189313.aspx</a></p><h2 style="box-sizing: border-box; margin: 0.2rem 0px 0.5rem; padding: 0px; color: rgb(34, 34, 34); font-style: normal; font-weight: normal; text-rendering: optimizeLegibility; font-size: 2.3125rem; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: center; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">Query Hints</h2><p style="box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 20px; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-size: 16px; font-weight: normal; text-rendering: optimizeLegibility; color: rgb(139, 137, 137); text-align: left; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">Using Query Hints, it’s possible to force SQL Server to use specific join types. However, <strong style="box-sizing: border-box; font-weight: bold;">it’s highly not recommended</strong> to do so especially in production environments, because the same join type may not be the best choice forever (because data can change), and SQL Server Optimizer usually has it right (assuming statistics are up-to-date).</p><p style="box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 20px; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-size: 16px; font-weight: normal; text-rendering: optimizeLegibility; color: rgb(139, 137, 137); text-align: left; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">I’ll talk about them just so you can experiment with the different join types on your test environment and see the differences.</p><p style="box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 20px; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-size: 16px; font-weight: normal; text-rendering: optimizeLegibility; color: rgb(139, 137, 137); text-align: left; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">To force SQL Server to use specific join types using query hints, you add the <strong style="box-sizing: border-box; font-weight: bold;">OPTION</strong> clause at the end of the query, and use the keywords<strong style="box-sizing: border-box; font-weight: bold;"> LOOP JOIN</strong>, <strong style="box-sizing: border-box; font-weight: bold;">MERGE JOIN</strong> or <strong style="box-sizing: border-box; font-weight: bold;">HASH JOIN</strong>.</p><p style="box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 20px; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-size: 16px; font-weight: normal; text-rendering: optimizeLegibility; color: rgb(139, 137, 137); text-align: left; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">Try executing the above queries with different join hints and see what happens:</p><p style="box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 20px; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-size: 16px; font-weight: normal; text-rendering: optimizeLegibility; color: rgb(139, 137, 137); text-align: left; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"></p><div style="box-sizing: border-box; margin: 12px 0px; padding: 0px; text-align: left; overflow: hidden !important; position: relative !important; direction: ltr !important; width: 882px; font-family: Monaco, MonacoRegular, &apos;Courier New&apos;, monospace; font-weight: 500; border: 1px solid rgb(153, 153, 153) !important; text-shadow: none !important; color: rgb(34, 34, 34); font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-size: 12px !important; height: auto; background: rgb(253, 253, 253) !important;"><div style="box-sizing: border-box; margin: 0px; padding: 0px; font-family: Monaco, MonacoRegular, &apos;Courier New&apos;, monospace !important; border: 0px; text-align: left; width: 880px; overflow: hidden; position: relative; z-index: 1; background: 0px 50%;"><table style="box-sizing: border-box; border: none !important; margin-bottom: 0px !important; table-layout: auto !important; font-size: 12px; padding: 0px !important; margin-right: 0px !important; margin-left: 0px; margin-top: 0px !important; font-family: Monaco, MonacoRegular, &apos;Courier New&apos;, monospace !important; border-spacing: 0px !important; border-collapse: collapse !important; background: none !important;width:880px;"><tbody style="box-sizing: border-box; font-family: Monaco, MonacoRegular, &apos;Courier New&apos;, monospace !important;"><tr style="box-sizing: border-box; font-family: Monaco, MonacoRegular, &apos;Courier New&apos;, monospace !important; padding: 0px !important; border: none !important; vertical-align: top !important; margin: 0px !important; background: 0px 50%;"><td style="box-sizing: border-box; margin: 0px !important; padding: 0px !important; color: rgb(84, 153, 222) !important; font-size: 0.875rem; text-align: left; display: table-cell; font-family: Monaco, MonacoRegular, &apos;Courier New&apos;, monospace !important; vertical-align: top !important; border: 0px; background: rgb(223, 239, 255) !important;width:3.977272727272727%;"><div style="box-sizing: border-box; margin: 0px; padding: 0px; font-family: Monaco, MonacoRegular, &apos;Courier New&apos;, monospace !important; border: 0px; text-align: left; white-space: nowrap; font-size: 12px !important; background: 0px 50%;"><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: center; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: 0px 50%;">1</div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: center; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(49, 124, 197) !important; background: rgb(200, 225, 250) !important;">2</div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: center; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: 0px 50%;">3</div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: center; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(49, 124, 197) !important; background: rgb(200, 225, 250) !important;">4</div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: center; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: 0px 50%;">5</div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: center; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(49, 124, 197) !important; background: rgb(200, 225, 250) !important;">6</div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: center; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: 0px 50%;">7</div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: center; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(49, 124, 197) !important; background: rgb(200, 225, 250) !important;">8</div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: center; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: 0px 50%;">9</div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: center; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(49, 124, 197) !important; background: rgb(200, 225, 250) !important;">10</div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: center; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: 0px 50%;">11</div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: center; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(49, 124, 197) !important; background: rgb(200, 225, 250) !important;">12</div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: center; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: 0px 50%;">13</div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: center; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(49, 124, 197) !important; background: rgb(200, 225, 250) !important;">14</div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: center; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: 0px 50%;">15</div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: center; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(49, 124, 197) !important; background: rgb(200, 225, 250) !important;">16</div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: center; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: 0px 50%;">17</div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: center; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(49, 124, 197) !important; background: rgb(200, 225, 250) !important;">18</div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: center; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: 0px 50%;">19</div></div></td><td style="box-sizing: border-box; margin: 0px !important; padding: 0px !important; color: rgb(34, 34, 34); font-size: 0.875rem; text-align: left; display: table-cell; font-family: Monaco, MonacoRegular, &apos;Courier New&apos;, monospace !important; vertical-align: top !important; border: 0px; background: 0px 50%;width:97%;"><div style="box-sizing: border-box; margin: 0px; padding: 0px; font-family: Monaco, MonacoRegular, &apos;Courier New&apos;, monospace !important; border: none !important; text-align: left; color: rgb(0, 0, 0); white-space: pre; overflow: visible; tab-size: 4; font-size: 12px !important; background: none !important;"><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: left; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: 0px 50%;"><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(128, 0, 128) !important;">SELECT</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">OC</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">.</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">CustomerID</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">,</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">OH</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">.</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">SalesOrderID</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: left; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: rgb(247, 247, 247) !important;"><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(128, 0, 128) !important;">FROM</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">Sales</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">.</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">SalesOrderHeader</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(128, 0, 128) !important;">AS</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">OH</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: left; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: 0px 50%;"><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(128, 0, 128) !important;">JOIN</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">Sales</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">.</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">Customer</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(128, 0, 128) !important;">AS</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">OC</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: left; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: rgb(247, 247, 247) !important;"><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(128, 0, 128) !important;">ON</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">OH</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">.</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">CustomerID</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 111, 224) !important;">=</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">OC</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">.</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">CustomerID</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: left; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: 0px 50%;"><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(128, 0, 128) !important;">OPTION</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">(</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">HASH</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(128, 0, 128) !important;">JOIN</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">)</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: left; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: rgb(247, 247, 247) !important;"> </div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: left; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: 0px 50%;"><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(128, 0, 128) !important;">SELECT</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">OC</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">.</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">FirstName</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">,</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">OC</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">.</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">LastName</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">,</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">OH</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">.</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">SalesOrderID</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: left; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: rgb(247, 247, 247) !important;"><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(128, 0, 128) !important;">FROM</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">Sales</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">.</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">SalesOrderHeader</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(128, 0, 128) !important;">AS</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">OH</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: left; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: 0px 50%;"><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(128, 0, 128) !important;">JOIN</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">Person</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">.</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">Contact</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(128, 0, 128) !important;">AS</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">OC</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: left; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: rgb(247, 247, 247) !important;"><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(128, 0, 128) !important;">ON</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">OH</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">.</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">ContactID</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 111, 224) !important;">=</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">OC</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">.</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">ContactID</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: left; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: 0px 50%;"><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(128, 0, 128) !important;">WHERE</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">OC</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">.</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">FirstName</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(128, 0, 128) !important;">LIKE</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 128, 0) !important;">'John%'</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: left; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: rgb(247, 247, 247) !important;"><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(128, 0, 128) !important;">OPTION</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">(</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">LOOP</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(128, 0, 128) !important;">JOIN</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">)</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: left; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: 0px 50%;"> </div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: left; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: rgb(247, 247, 247) !important;"><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(128, 0, 128) !important;">SELECT</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">OC</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">.</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">FirstName</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">,</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">OC</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">.</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">LastName</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">,</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">OH</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">.</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">SalesOrderID</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: left; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: 0px 50%;"><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(128, 0, 128) !important;">FROM</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">Sales</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">.</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">SalesOrderHeader</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(128, 0, 128) !important;">AS</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">OH</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: left; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: rgb(247, 247, 247) !important;"><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(128, 0, 128) !important;">JOIN</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">Person</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">.</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">Contact</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(128, 0, 128) !important;">AS</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">OC</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: left; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: 0px 50%;"><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(128, 0, 128) !important;">ON</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">OH</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">.</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">ContactID</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 111, 224) !important;">=</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">OC</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">.</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">ContactID</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: left; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: rgb(247, 247, 247) !important;"><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(128, 0, 128) !important;">WHERE</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">OC</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">.</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">FirstName</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(128, 0, 128) !important;">LIKE</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 128, 0) !important;">'John%'</span></div><div style="box-sizing: border-box; margin: 0px; padding: 0px 5px; font-family: inherit; border: 0px; text-align: left; height: inherit; font-size: inherit !important; font-weight: inherit !important; background: 0px 50%;"><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(128, 0, 128) !important;">OPTION</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">(</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">MERGE</span> <span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(128, 0, 128) !important;">JOIN</span><span style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">)</span></div></div></td></tr></tbody></table></div></div><p style="box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 20px; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-size: 16px; font-weight: normal; text-rendering: optimizeLegibility; color: rgb(139, 137, 137); text-align: left; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"></p><h2 style="box-sizing: border-box; margin: 0.2rem 0px 0.5rem; padding: 0px; color: rgb(34, 34, 34); font-style: normal; font-weight: normal; text-rendering: optimizeLegibility; font-size: 2.3125rem; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: center; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">Summary</h2><h3 style="box-sizing: border-box; margin: 0.2rem 0px 0.5rem; padding: 0px; color: rgb(34, 34, 34); font-style: normal; font-weight: normal; text-rendering: optimizeLegibility; font-size: 1.6875rem; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: center; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">Nested Loops</h3><ul style="box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 40px; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-size: 16px; list-style-position: outside; color: rgb(34, 34, 34); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: center; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><li style="box-sizing: border-box; margin: 0px; padding: 0px; text-align: left;"><div style="box-sizing: border-box; margin: 0px; padding: 0px;">Complexity: O(NlogM)</div></li><li style="box-sizing: border-box; margin: 0px; padding: 0px; text-align: left;"><div style="box-sizing: border-box; margin: 0px; padding: 0px;">Used usually when one table is significantly small</div></li><li style="box-sizing: border-box; margin: 0px; padding: 0px; text-align: left;"><div style="box-sizing: border-box; margin: 0px; padding: 0px;">The larger table has an index which allows seeking it using the join key</div></li></ul><h3 style="box-sizing: border-box; margin: 0.2rem 0px 0.5rem; padding: 0px; color: rgb(34, 34, 34); font-style: normal; font-weight: normal; text-rendering: optimizeLegibility; font-size: 1.6875rem; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: center; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">Merge Join</h3><ul style="box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 40px; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-size: 16px; list-style-position: outside; color: rgb(34, 34, 34); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: center; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><li style="box-sizing: border-box; margin: 0px; padding: 0px; text-align: left;"><div style="box-sizing: border-box; margin: 0px; padding: 0px;">Complexity: O(N+M)</div></li><li style="box-sizing: border-box; margin: 0px; padding: 0px; text-align: left;"><div style="box-sizing: border-box; margin: 0px; padding: 0px;">Both inputs are sorted on the join key</div></li><li style="box-sizing: border-box; margin: 0px; padding: 0px; text-align: left;"><div style="box-sizing: border-box; margin: 0px; padding: 0px;">An equality operator is used</div></li><li style="box-sizing: border-box; margin: 0px; padding: 0px; text-align: left;"><div style="box-sizing: border-box; margin: 0px; padding: 0px;">Excellent for very large tables</div></li></ul><h3 style="box-sizing: border-box; margin: 0.2rem 0px 0.5rem; padding: 0px; color: rgb(34, 34, 34); font-style: normal; font-weight: normal; text-rendering: optimizeLegibility; font-size: 1.6875rem; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: center; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">Hash Match</h3><ul style="box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 40px; font-family: &apos;Open Sans Hebrew&apos;, sans-serif; font-size: 16px; list-style-position: outside; color: rgb(34, 34, 34); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: center; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><li style="box-sizing: border-box; margin: 0px; padding: 0px; text-align: left;"><div style="box-sizing: border-box; margin: 0px; padding: 0px;">Complexity: O(N*h<sub style="box-sizing: border-box;">c</sub>+M*h<sub style="box-sizing: border-box;">m</sub>+J)</div></li><li style="box-sizing: border-box; margin: 0px; padding: 0px; text-align: left;"><div style="box-sizing: border-box; margin: 0px; padding: 0px;">Last-resort join type</div></li><li style="box-sizing: border-box; margin: 0px; padding: 0px; text-align: left;"><div style="box-sizing: border-box; margin: 0px; padding: 0px;">Uses a hash table and a dynamic hash match function to match rows</div></li></ul></div></span>
</div></body></html> 